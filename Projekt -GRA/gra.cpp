#include <iostream>
#include"Console.h"
#include"Windows.h"
#include <conio.h>
#include<stdlib.h>
#include<time.h>
#include <thread>
#include <windows.h>
#include <Windows.h>
#include "enemy.h"
#include <cstdlib>
#include <sstream>
#include<string>
using namespace std;

bool gamerun = true;
Console console;
enemy enemy1;
enemy enemy2;
int main()
{
	cout << "_________________,8*________8____*888__`*88888b._ _____________   88888888888888888888888888                             88888888888888888888888888" << endl;
	cout << "_______________,d8________________*88___________*8 8b.__________  888888888888888888888888888                           888888888888888888888888888" << endl;
	cout << "______________d8`__________________*8b____________ ___*8b.______  8888888888888888888888888888                         8888888888888888888888888888" << endl;
	cout << "____________,d8`____________________*8.___________ _______*88b._  88888888888888888888888888888                       88888888888888888888888888888" << endl;
	cout << "___________d8P_______________________88.__________ _____________  888888888888888888888888888888                     888888888888888888888888888888" << endl;
	cout << "_________,88P________________________888__________ _____________  8888888888888888888888888888888                   8888888888888888888888888888888" << endl;
	cout << "________d888*_______.d88P____________888__________ _____________  88888888888888888888888888888888                 88888888888888888888888888888888" << endl;
	cout << "_______d8888b..d888888*______________888__________ _____________  8888888888888888 8888888888888888               8888888888888888 8888888888888888" << endl;
	cout << "_____,888888888888888b.______________888__________ _____________  8888888888888888  8888888888888888             8888888888888888  8888888888888888" << endl;
	cout << "____,8*;88888P*788888888ba._____888___________ ____________       8888888888888888   8888888888888888           8888888888888888   8888888888888888" << endl;
	cout << "___,8;,8888*________`88888*__________d88*_________ ______________ 8888888888888888    8888888888888888         8888888888888888    8888888888888888" << endl;
	cout << "___)8e888*__________,88888be.________888__________ ______________ 8888888888888888     8888888888888888       8888888888888888     8888888888888888" << endl;
	cout << "__,d888`___________,8888888*_____d888___________ _____________    8888888888888888      8888888888888888     8888888888888888      8888888888888888" << endl;
	cout << "_,d88P`___________,8888888Pb._____d888`___________ _____________  8888888888888888       8888888888888888   8888888888888888       8888888888888888" << endl;
	cout << "_888*____________,88888888*___.d8888*____________ _____________   8888888888888888        88888888888888888888888888888888         8888888888888888" << endl;
	cout << "_`88____________,888888888____.d88888b____________ _____________  8888888888888888           88888888888888888888888888            8888888888888888" << endl;
	cout << "__`P___________,8888888888bd888888*_______________ _____________  8888888888888888              88888888888888888888               8888888888888888" << endl;
	cout << "_______________d888888888888d888*_________________ _____________  8888888888888888                 88888888888888                  8888888888888888" << endl;
	cout << "_______________8888888888888888b._________________ _____________  8888888888888888                    88888888                     8888888888888888" << endl;
	cout << "_______________88*._*88888888888b.________.db_____ _____________  8888888888888888                       88                        8888888888888888" << endl;
	cout << "_______________`888b.`8888888888888b._.d8888P_____ _____________  8888888888888888                                                 8888888888888888" << endl;
	cout << "________________*88b.`*8888888888888888888888b... _____________   8888888888888888                                                 8888888888888888" << endl;
	cout << "_________________*888b.`*8888888888P*78888888888 88e.________     8888888888888888                                                 8888888888888888" << endl;
	cout << "__________________88888b.`*.d8888b*`88888P *___________           8888888888888888                                                 8888888888888888" << endl;
	cout << "__________________`888888b_____.d88888888888*`888 8.___________   8888888888888888       88           88888888          8888888    8888888888888888" << endl;
	cout << "___________________)888888.___d888888888888P___`88 88888b.______  8888888888888888      8888               888          88         8888888888888888" << endl;
	cout << "__________________,88888*____d88888888888*`____`8 888b_________   8888888888888888     88   88            888           88         8888888888888888" << endl;
	cout << "_________________,8888*____.8888888888P`__________ `888b.________ 8888888888888888     88   88           888            8888       8888888888888888" << endl;
	cout << "________________,888*______888888888b...__________ __`888P88b.____8888888888888888     8888888          888             88         8888888888888888" << endl;
	cout << "_______.db.___,d88*________88888888888888b________ __`8888_______ 8888888888888888     88   88         888              88         8888888888888888" << endl;
	cout << "___,d888888b.8888`_________`*888888888888888888P`_ __`888b._____  8888888888888888     88   88        88888888          8888888    8888888888888888" << endl;
	cout << "__/*8888b*`______________`*8888P*``8888`______ _`8888b.__         8888888888888888                                                 8888888888888888" << endl;
	cout << "_______/*88`_________________.ed8b..__.d888P`____________ `88888_ 8888888888888888                                                 8888888888888888" << endl;
	cout << "____________________________d8*888888888P*_______ ________`88b_   8888888888888888                                                 8888888888888888" << endl;
	cout << "___________________________(*``,d8888*`_________ ___________`88   8888888888888888                                                 8888888888888888" << endl;
	cout << "______________________________(*`_________________ ______________`8888888888888888                                                 8888888888888888" << endl;
	
	system("pause");
	system("cls");
	console.draw();
	console.update();
	while(gamerun)
	{
		for (;;)
		{
			
			stringstream ss2;
			ss2 << health;

			cout << "Arrows: " << console.arrows << " Health: " << health << endl;
			system("pause>nul");

			int w = 6;
			int q = 7;
			enemy1.Init(w, q);
			w = 12;
			q = 11;
			enemy2.Init(w, q);


			if (GetAsyncKeyState('W'))
			{

				console.Move(-1, 0);
			}

			if (GetAsyncKeyState('S'))
			{

				console.Move(1, 0);
			}

			if (GetAsyncKeyState('A'))
			{

				console.Move(0, -1);
			}

			if (GetAsyncKeyState('D'))
			{

				console.Move(0, 1);
			}

			if (GetAsyncKeyState(VK_UP))
			{
				if (console.arrows > 0)
				{
					Beep(220, 200);
					console.Shoot(-1, 0);
					console.arrows--;

				}
			}

			if (GetAsyncKeyState(VK_DOWN))
			{
				if (console.arrows > 0)
				{
					Beep(220, 200);
					console.Shoot(1, 0);
					console.arrows--;

				}
			}

			if (GetAsyncKeyState(VK_LEFT))
			{
				if (console.arrows > 0)
				{
					Beep(220, 200);
					console.Shoot(0, -1);
					console.arrows--;

				}
			}

			if (GetAsyncKeyState(VK_RIGHT))
			{
				if (console.arrows > 0)
				{
					Beep(220, 200);
					console.Shoot(0, 1);
					console.arrows--;

				}
			}



			if (GetAsyncKeyState('R'))
			{

				enemy1.reset();
				enemy2.reset();
				console.reset();

			}

			if (health <= 0)
			{
				int l = 0;
				do {
					system("cls");
					cout << " Game Over " << endl;
					cout << "One more game ? " << endl;
					cout << "1.No 2.Yes" << endl;
					Beep(246.9, 200);
					Beep(207, 200);
					Beep(185, 200);
					Beep(174.6, 200);
					int c;
					c = _getch();

					system("pause");
					switch (c)
					{

					case 49:
						gamerun = false;
						return 1;
					case 50:
					{

						enemy1.reset();
						enemy2.reset();
						console.reset();
						l = 1;
						break;
					}
					default:
					{
						cout << "Something went wrong" << endl;

						system("cls");
						break;
					}

					}

				} while (l != 1);
			}


		}
	}




	
	return 0;
}
